<link href="/res/leaflet/leaflet.css" rel="stylesheet">
<script src="/res/leaflet/leaflet.js"></script>

<script src="/res/core/js/page-widget-pivot.js"></script>

<div class="panel ez no-padding hardcore">
	<div class="panel-heading">
		<h3 class="no-margin">
			<button class="btn-toggle-filter no-padding"></button>
			Pivot
		</h3>
		<div class="panel-nav-button">
			<div class="form-group relative align-right no-margin no-padding hardcore">
				<button class="btn btn-sm btn-primary" data-bind="click: pvt.showConfig, visible: rpt.mode() == 'render'">
					<i class="fa fa-gear"></i> Show Configuration
				</button>
				<button class="btn btn-sm btn-primary" data-bind="click: pvt.showAndRefreshPivot, visible: rpt.mode() == ''">
					<i class="fa fa-eye"></i> Show Pivot
				</button>
			</div>
		</div>
	</div>
	<div class="panel-body" data-bind="visible: rpt.mode() == ''">
		<p>Build pivot grid to compare value of data point based on selected dimensions (rows and columns).</p>

		<div class="report-module report-module-pivot">
			<div class="col-md-4">
				<div class="col-md-12 pivot-wrapper pivot-wrapper-column" data-bind="css: { 'read-only': !pvt.enableDimensions() }">
					<div class="wrapper-inner" data-module="column">
						<h3 class="no-margin">
							<div class="pull-left">
								<i class="fa fa-columns"></i>
								Columns
							</div>
							<div class="pull-right">
								<button class="add-data-point tooltipster" title="Click to add more data point" data-bind="click: pvt.addColumn">
									<span class="fa fa-plus"></span>
								</button>
							</div>
							<div class="clearfix"></div>
						</h3>
						<div class="wrapper" style="min-height: 242px;">
							<div class="list-group ez pivot-section pivot-section-columns" data-bind="foreach: pvt.dimensions" style="min-height: 242px;">
								<div class="input-group input-group-sm ez width-full">
									<div>
										<select style="width: 100%;" type="text" data-bind="kendoDropDownList: { data: pvt.optionDimensions, value: $data.field, optionLabel: 'Pick ...', dataValueField: 'field', dataTextField: 'name' }"></select>
									</div>
									<span class="input-group-addon tooltipster clickable" title="Click to remove" data-bind="attr: { 'data-id': $data.field }" onclick="pvt.removeFrom(this, 'columns')">
										<i class="fa fa-close"></i>
									</span>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-12 pivot-wrapper pivot-wrapper-row" data-bind="css: { 'read-only': !pvt.enableRows() }">
					<div class="wrapper-inner" data-module="row">
						<h3 class="no-margin">
							<div class="pull-left">
								<i class="fa fa-reorder"></i>
								Rows
							</div>
							<div class="pull-right">
								<button class="add-data-point tooltipster" title="Click to add more data point" data-bind="click: pvt.addRow">
									<span class="fa fa-plus"></span>
								</button>
							</div>
							<div class="clearfix"></div>
						</h3>
						<div class="wrapper" style="min-height: 242px;">
							<div class="list-group ez pivot-section pivot-section-rows" data-bind="foreach: pvt.rows" style="min-height: 242px;">
								<div class="input-group input-group-sm ez width-full">
									<div>
										<select style="width: 100%;" type="text" data-bind="kendoDropDownList: { data: pvt.optionRows, value: $data.field, optionLabel: 'Pick ...', dataValueField: 'field', dataTextField: 'name' }"></select>
									</div>
									<span class="input-group-addon tooltipster clickable" title="Click to remove" data-bind="attr: { 'data-id': $data.field }" onclick="pvt.removeFrom(this, 'rows')">
										<i class="fa fa-close"></i>
									</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>


			<div class="col-md-8 pivot-wrapper" data-bind="css: { 'read-only': !pvt.enableDataPoints() }">
				<div class="wrapper-inner" data-module="value">
					<h3 class="no-margin">
						<div class="pull-left">
							<i class="fa fa-bullseye"></i>
							Data Points
						</div>
						<div class="pull-right">
							<button class="add-data-point tooltipster" title="Click to add more data point" data-bind="click: pvt.addDataPoint">
								<span class="fa fa-plus"></span>
							</button>
						</div>
						<div class="clearfix"></div>
					</h3>
					<div class="wrapper" style="min-height: 524px;">
						<div class="list-group ez pivot-section pivot-section-data-point" data-bind="foreach: pvt.dataPoints" style="min-height: 524px;">
							<div class="input-group input-group-sm ez width-full">
								<span class="input-group-addon">Data Point</span>
								<div>
									<select style="width: 100%;" type="text" data-bind="kendoDropDownList: { data: pvt.optionDataPoints, value: $data.field, optionLabel: 'Pick ...', dataValueField: 'field', dataTextField: 'name' }"></select>
								</div>
								<span class="input-group-addon">Aggr</span>
								<div>
									<select style="width: 100%;" type="text" data-bind="kendoDropDownList: { data: pvt.optionAggregates, value: $data.aggr, optionLabel: 'Pick ...', dataValueField: 'aggr', dataTextField: 'name' }"></select>
								</div>
								<span class="input-group-addon tooltipster clickable" title="Click to remove" data-bind="attr: { 'data-index': $index() }" onclick="pvt.removeFrom(this, 'dataPoints')">
									<i class="fa fa-close"></i>
								</span>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="clearfix"></div>
		</div>
	</div>

	<div class="panel-body" data-bind="visible: rpt.mode() == 'render'">
		<p>Generated pivot grid.</p>

		{{template "_loader.html"}}

		<div id="pivot-wrapper" data-bind="visible: !app.loader()">
			<div class="pivot-wrapper-inner">
				<div class="pivot"></div>
			</div>
		</div>
	</div>
</div>

